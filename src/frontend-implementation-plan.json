{
  "kind": "implementation_plan",
  "version": "1.0",
  "title": "Implement manual revision completion workflow with missed revision indicators",
  "requirements": [
    {
      "id": "REQ-2",
      "summary": "Add visual indicators in the calendar view to show missed revisions in red for dates where scheduled revisions were not marked as reviewed",
      "acceptanceCriteria": [
        "Calendar dates with unreviewed past revisions display in red color",
        "Red indicators remain visible until the revision is marked as reviewed",
        "Visual distinction between upcoming (scheduled) and overdue (missed) revisions"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/CalendarView.tsx",
          "operation": "modify",
          "description": "Add red visual styling to calendar dates that have unreviewed past revisions. Implement logic to check if a revision date is in the past and not marked as reviewed (isReviewed: false). Apply distinct CSS classes for missed revisions (red) versus upcoming scheduled revisions. Use the existing RevisionSchedule data which includes the isReviewed field to determine status. Ensure the red indicator persists until the revision is marked as reviewed by checking isReviewed status from backend data."
        },
        {
          "path": "frontend/src/utils/reviewStatus.ts",
          "operation": "modify",
          "description": "Add utility function to identify missed (overdue and unreviewed) revision dates. Function should accept revision schedules and return dates where nextReview is in the past and isReviewed is false. This will support the calendar view's need to highlight missed revisions in red."
        }
      ]
    },
    {
      "id": "REQ-3",
      "summary": "Add 'Mark as Reviewed' action button in the TodayView dashboard that allows users to complete revisions for subtopics due on the selected date",
      "acceptanceCriteria": [
        "Button is visible for each pending revision in the dashboard",
        "Clicking the button marks the revision as completed and updates the UI immediately",
        "Completed revisions show completion status and timestamp"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/TodayView.tsx",
          "operation": "modify",
          "description": "Add 'Mark as Reviewed' button for each subtopic displayed in TodayView. Wire the button to call the existing markRevisionAsReviewed backend function with the subtopicId. Use the useMarkRevisionAsReviewed mutation hook (to be created in useQueries.ts). Update the UI to show completion status after marking. Display the revision's isReviewed status and show visual feedback when a revision is completed. Handle both due today and overdue sections appropriately."
        },
        {
          "path": "frontend/src/hooks/useQueries.ts",
          "operation": "modify",
          "description": "Add useMarkRevisionAsReviewed mutation hook that calls actor.markRevisionAsReviewed(subTopicId). Include toast notifications for success and error states. Invalidate relevant queries after successful mutation: revisionSchedule, todaySubTopics, plannedRevisionDates, and allPlannedRevisionDates to ensure calendar and dashboard views refresh with updated isReviewed status."
        }
      ]
    },
    {
      "id": "REQ-4",
      "summary": "Add 'Mark as Reviewed' action button in the SubTopicScheduleView calendar dialog that allows users to complete revisions when viewing a subtopic's schedule from the calendar",
      "acceptanceCriteria": [
        "Button appears for pending revisions when viewing subtopic schedule from calendar",
        "Marking a revision as reviewed updates both the schedule view and calendar display",
        "Button is disabled or hidden for already completed revisions"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/SubTopicScheduleView.tsx",
          "operation": "modify",
          "description": "Add 'Mark as Reviewed' button in the SubTopicScheduleView dialog. Use the useMarkRevisionAsReviewed mutation hook to call markRevisionAsReviewed for the current subtopic. Show the button only when the subtopic has unreviewed revisions (check isReviewed status from revision schedule data). Disable or hide the button if the revision is already marked as reviewed. Update the dialog UI immediately after marking to reflect the new reviewed status. Display completion timestamp when available."
        }
      ]
    },
    {
      "id": "REQ-5",
      "summary": "Ensure that when a missed revision is marked as reviewed after its scheduled date, it transitions from red (missed) to completed status in all views",
      "acceptanceCriteria": [
        "Marking a late revision as reviewed removes red missed indicators",
        "Calendar updates to reflect completion status immediately",
        "Dashboard no longer shows the revision as overdue after completion"
      ],
      "file_operations": [
        {
          "path": "frontend/src/components/CalendarView.tsx",
          "operation": "modify",
          "description": "Ensure that when revision schedules are refetched after marking as reviewed, the calendar immediately removes red missed indicators from dates where revisions are now marked as reviewed. Verify that the calendar re-renders correctly when the plannedRevisionDates or revisionSchedule queries are invalidated. Update conditional rendering logic to check isReviewed status and only show red indicators for dates with unreviewed past revisions."
        },
        {
          "path": "frontend/src/components/TodayView.tsx",
          "operation": "modify",
          "description": "Ensure that after marking a revision as reviewed, the TodayView immediately removes the subtopic from the overdue or due today list if it no longer has pending revisions. Verify proper query invalidation triggers re-render with updated data. Update the overdue calculation logic to exclude revisions where isReviewed is true."
        }
      ]
    }
  ]
}